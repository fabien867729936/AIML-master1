# 卷积神经网络的应用

## 卷积神经网络

在机器学习中，卷积神经网络CNN是一种前馈神经网络，它的人工神经元可以响应一部分覆盖范围内的周围单元，可以应用于语音识别、图像处理和图像识别等领域。  CNN在本质上是一种输入到输出的映射，它能够学习大量的输入与输出之间的映射关系，而不需要任何输入和输出之间的精确的数学表达式，只要用已知的模式对卷积网络加以训练，网络就具有输入输出对之间的映射能力。卷积网络执行的是有导师训练，所以其样本集是由形如：（输入向量，理想输出向量）的向量对构成的。所有这些向量对，都应该是来源于网络即将模拟的系统的实际“运行”结果。它们可以是从实际运行系统中采集来的。在开始训练前，所有的权都应该用一些不同的小随机数进行初始化。“小随机数”用来保证网络不会因权值过大而进入饱和状态而导致训练失败；“不同”用来保证网络可以正常地学习。

### 一、目标检测

目标检测的主要任务是从图像中定位感兴趣的目标，需要准确判断每个目标的具体类别，并给出每个目标的边界框。
a、预处理，对待检测图像进行图像去噪、图像增强、色彩空间转换等操作
b、在待检测图像中滑动一个固定大小的窗口，将窗口中的子图像作为候选区
c、利用特定算法对候选区域进行特征提取
d、从特征向量中选择具有代表性的特征，降低特征维数
e、利用特征分类器对特征进行分类，判定候区是否包含了目标及其类别
f、合并判定为统一类别的相交候选区，计算出每个目标的边界框，完成目标检测。

### 二、语义分割

就是把感兴趣的内容从图像上分割出来，但是一般会对这个目标加上一定的语义信息，即语义标签，把加上语义的图像分割称为图像语义分割。卷积和池化提取特征，缩小特征映射，通过反卷积和upooling层来进行逆向操作，将特征重新映射到原来的图像大小上。
分割技术：阈值分割、边缘检测、区域提取、特定理论工具

### 三、股票检测

利用卷积网络来预测股票价格的变动，即利用卷积网络来预测过去价格波动的时间序列，其目的是利用它们来买卖股票，以赚取利润。
1.数据预处理
           a、中位数去极值：设第T期某因子在所有个股上的暴露度序列为 Di，DM为该序列中位数，DM1为序列|Di-DM|的中位数，则将           序列Di中所有大于DM+5DM1的数重设为DM+5DM1，将序列Di中所有小于DM-5DM1的数重设为DM+5DM1；
           b、缺失值处理：得到新的因子暴露度序列后，将因子暴露度缺失的地方设为中信一级行业相同个股的平均值；
           c、行业市值中性化：将填充缺失值后的因子暴露度对行业哑变量和取对数后的市值做线性回归，取残差作为新的因子暴露度；
           d、标准化：将中性化处理后的因子暴露度序列减去其现在的均值、除以其标准差，得到一个新的近似服从N(0, 1)分布的序列。
           e、要使用卷积神经网络，需要提供二维的特征数据，我们按照图表3的形式，将某只股票多个截面期的因子数据组织成类似于图片的二维数据，总共82行（对应82个因子），5列（对应5个截面期），这样在每个月截面上，就可以得到上千张“股票图片”。

2.卷积和池化设计 
池化：也称为欠采样或下采样。主要用于特征降维，压缩数据和参数的数量，减小过拟合，同时提高模型的容错性。主要有：最大池化和平均池化 。通过池化层，使得原本44的特征图压缩成了22，从而降低了特征维度。

3.通道设计：一般通道的含义是，每个卷积层中卷积核的数量。
    
