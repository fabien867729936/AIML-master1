>>>>>> ## 举例说明BP神经网络的应用
#### 简介
+ 人工神经网络（Artificial Neural Netork，ANN）：由简单神经元经过相互连接形成网状结构，通过调节各连接的权重值改变连接的强度，进而实现感知判断。
+ 反向传播（Back Propagation，BP）算法：进一步推动了神经网络的发展。
  
##### 所以我们这次写的是反向传播神经网络的应用：
1. BP神经网络：按照误差逆向传播算法训练的多层前馈神经网络。
2. 基本原理：
    + 工神经网络无需事先确定输入输出之间映射关系的数学方程，仅通过自身的训练，学习某种规则，在给定输入值时得到最接近期望输出值的结果。作为一种智能信息处理系统，人工神经网络实现其功能的核心是算法。
    + BP算法：一种按误差反向传播(简称误差反传)训练的多层前馈网络。基本思想是梯度下降法，利用梯度搜索技术，以期使网络的实际输出值和期望输出值的误差均方差为最小。
    + 基本BP算法包括信号的前向传播和误差的反向传播两个过程。即计算误差输出时按从输入到输出的方向进行，而调整权值和阈值则从输出到输入的方向进行。
3. 结构：BP网络是在输入层与输出层之间增加若干层(一层或多层)神经元，这些神经元称为隐单元，它们与外界没有直接的联系，但其状态的改变，则能影响输入与输出之间的关系，每一层可以有若干个节点。
4. 应用：
   + 基于神经网络（多层感知器）识别手写数字
    - 数据集为经典的MNIST。
    - 输入加载数据的代码 ![](1.jpg)
   
    - 输入定义学习率、迭代次数、批大小、批数量（总样本数除以批大小）等参数，设置输入层大小为784，即将28*28的像素展开为一维行向量（一个输入图片784个值）。第一层和第二层神经元数量均为256，输出层的分类类别为0~9的数字，即10个类别的代码 ![](2.jpg)
    
    - 使用tf.random_normal()生成模型权重值参数矩阵和偏置值参数，并将其分别存储于weights和biases变量中，并定义多层感知机的神经网络模型。![](3.jpg)
  
    - 使用输入变量X初始化模型，定义损失函数为交叉熵，采用梯度下降法作为优化器（除此之外还可选MomentumOptimizer、AdagradOptimizer、AdamOptimizer）,并对模型中tf.placeholder定义的各种参数初始化。
    ![](4.jpg)

    - 将训练寄样本输入模型进行训练，并计算每个批次的平均损失，在每次迭代时输出模型的平均损失。![](5.jpg)
    
    - 模型训练完成，使用测试集样本对其评估，并计算其精确率。![](6.jpg)
    
    - 模型的Accuracy结果为87.8%。 
   +  基于Elman神经网络的能源消耗预测 ![](7.png) 
    - 预测实验结果图 ![](8.png)
    - 100天预测结果走势比对图 ![](9.png)